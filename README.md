# Набор скриптов tmdb_api
Cоздают локальную базу данных фильмов каталога [TMDB](https://www.themoviedb.org/). Предоставяют сервис поиска и подбора рекомендуемых к просмотру фильмов.

## Окружение и установка
Python должен быть установлен.

## Установка скрипта
- Скачайте код: [репозиторий GITHUB](https://github.com/evgeniya35/tmdb_api.git), или клонируйте `git` репозиторий в локальную папку:
```
git clone https://github.com/evgeniya35/tmdb_api.git
```
- Зарегистрирутесь на сайте [TMDB](https://www.themoviedb.org/) и получите персональный токен на странице параметров пользователя.

## Установка зависимостей
Используйте pip для установки зависимостей:
```bash
pip install -r requirements.txt
```

## Формирование базы фильмов
### make_own_db.py
Создаёт базу данных фильмов сервиса TMDB. Скрипт в цикле диапазона от 0 до 1000 последовательно загружает из сервиса TMDB карточки описания фильмов. Результат загрузки помещает в файл базы данных `MyFilmDB.json`. 
Использует функции `tmdb_helpers.py`.
Запуск `python make_own_db.py`.

### hello_api_TMDB.py
Выводит в консоль бюджет затраченный на производство фильма `id = 215`.

Использует функции `tmdb_helpers.py`. Предлагает пользователю в консоли скрытно ввести API key сервиса TMDB. Выполняет запрос к API сервиса TMDB.
Запуск `python tmdb_helpers.py`.


### tmdb_helpers.py
Содержит функции работы с API сервиса TMDB `https://api.themoviedb.org/`.
Предлагает пользователю в консоли скрытно ввести API key сервиса TMDB. 
Выполняет запрос к API сервиса TMDB. Результат запроса возвращает словарём. Структура словаря:
```
{'adult': False,
 'backdrop_path': '/el6KuGEa3z4JwnsmLSlD0BCCedH.jpg',
 'belongs_to_collection': {'backdrop_path': '/oLfS1lOmN2KIU2IQ200SDEPVEZe.jpg',
                           'id': 656,
                           'name': 'Пила (Коллекция)',
                           'poster_path': '/r6uEZkwAJ30lK0uKAfOiRd40ZSK.jpg'},
 'budget': 4000000,
 'genres': [{'id': 27, 'name': 'ужасы'}],
 'homepage': '',
 'id': 215,
 'imdb_id': 'tt0432348',
 'original_language': 'en',
 'original_title': 'Saw II',
 ....,
 ....
}
 ```
## Поиск фильма в базе и подбор рекомендаций
### find_similar.py
Поиск фильмов в локальной базе и подбор рекомендуемых к просмотру фильмов. 
Скрипт запрашивает в консоли у пользователя путь к файлу локальной базы фильмов `Enter path to DataBase:{MyFilmDB.json}`. Если файл не найден, выводит в консоль `File not found, sorry...`, завершает работу.
Далее запрашивает в консоли название фильма. Поиск осуществляет в оригинальном названии по точному совпадению. Если не находит, выводит в консоль `No such film in FilmsDB`, завершает работу. В случае успеха поиска, формирует список рекомендаций фильмов - функция **get_rating**. При формировании рекомендаций, фильмы из базы рейтингуются по удельными весам параметров найденного фильма:
```
# Параметр: Удельный вес параметра
'belongs_to_collection': 1000,
'original_language': 300,
'budget': 100,
'genres': 500
```

Функция `get_rating` возвращает список из 8-ми фильмов максимального рейтинга расчитанного согласно удельным весам параметров.
В конце скрипт выводит в консоль список из 8-ми фильмов в алфавитном порядке:
```
Enter film to search for:Saw
Four Rooms
Harold and Maude
Judgment Night
Life in Loops (A Megacities RMX)
Reservoir Dogs
Saw II
Saw III
Saw IV
Strangers on a Train
``` 
Использует `own_db_helpers.py`.
Запуск `python find_similar.py`.

### search_in_db.py
Ищет фильм в локальной базе фильмов.
Запрашивает в консоли у пользователя путь к файлу локальной базы фильмов `Enter path to DataBase:{MyFilmDB.json}`. Если файл не найден, выводит в консоль `File not found, sorry...`, завершает работу.
Далее запрашивает ввод названия фильма. Поиск осуществляет в оригинальном названии по частичному совпадению (буквосочетанию). В случае успеха поиска, выводит в консоль сортированный список уникальных наименований найденных фильмов:
```
Enter film to search for:saw
Saw
Saw II
Saw III
Saw IV
```
Использует `own_db_helpers.py`.
Запуск `python search_in_db.py`.

### own_db_helpers.py
Загружает файл базы данных фильмов. 
Проверяет наличие файла базы по входящему пути. В случае успеха, возвращает содержимое базы словарём, иначе `None`.
